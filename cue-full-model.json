{
  "helmApp": {},
  "helmRepository": {},
  "cluster": {
    "tmm": {
      "name": "tmm",
      "nodeType": "multipass",
      "kubeType": "k3s",
      "fqdn": "odell.sh",
      "onePasswordVault": "homelab-tmm"
    },
    "alpha": {
      "name": "alpha",
      "nodeType": "physical",
      "kubeType": "k3s",
      "fqdn": "alpha.odell.sh",
      "onePasswordVault": "homelab-alpha"
    }
  },
  "flux": {
    "helmrepo": {}
  },
  "kubernetes": {
    "namespace": {
      "storage": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "storage",
            "secrets-injection": "enabled"
          },
          "name": "storage"
        }
      },
      "secrets": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "secrets",
            "secrets-injection": "enabled"
          },
          "name": "secrets"
        }
      },
      "network": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "network",
            "secrets-injection": "enabled"
          },
          "name": "network"
        }
      },
      "ha": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "ha",
            "secrets-injection": "enabled"
          },
          "name": "ha"
        }
      },
      "mon": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "mon",
            "secrets-injection": "enabled"
          },
          "name": "mon"
        }
      },
      "data": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "data",
            "secrets-injection": "enabled"
          },
          "name": "data"
        }
      }
    }
  }
}
{
  "helmApp": {
    "cert-manager": {
      "namespace": "network",
      "helmRepository": {
        "name": "cert-manager",
        "url": "https://charts.jetstack.io"
      },
      "chartName": "cert-manager",
      "releaseName": "cert-manager",
      "values": {
        "installCRDs": true,
        "prometheus": {
          "servicemonitor": {
            "enabled": false
          }
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "cert-manager",
            "namespace": "network"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "cert-manager",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "cert-manager"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "installCRDs": true,
            "prometheus": {
              "servicemonitor": {
                "enabled": false
              }
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "cert-manager",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://charts.jetstack.io"
          }
        }
      }
    },
    "external-dns": {
      "namespace": "network",
      "helmRepository": {
        "name": "external-dns",
        "url": "https://kubernetes-sigs.github.io/external-dns"
      },
      "chartName": "external-dns",
      "releaseName": "external-dns",
      "values": {
        "policy": "sync",
        "txtPrefix": "externaldns-",
        "txtOwnerId": "homelab",
        "provider": "aws",
        "env": [
          {
            "name": "AWS_ACCESS_KEY_ID",
            "valueFrom": {
              "secretKeyRef": {
                "name": "aws-certbot",
                "key": "access_key"
              }
            }
          },
          {
            "name": "AWS_SECRET_ACCESS_KEY",
            "valueFrom": {
              "secretKeyRef": {
                "name": "aws-certbot",
                "key": "secret_key"
              }
            }
          }
        ]
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "external-dns",
            "namespace": "network"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "external-dns",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "external-dns"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "policy": "sync",
            "txtPrefix": "externaldns-",
            "txtOwnerId": "homelab",
            "provider": "aws",
            "env": [
              {
                "name": "AWS_ACCESS_KEY_ID",
                "valueFrom": {
                  "secretKeyRef": {
                    "name": "aws-certbot",
                    "key": "access_key"
                  }
                }
              },
              {
                "name": "AWS_SECRET_ACCESS_KEY",
                "valueFrom": {
                  "secretKeyRef": {
                    "name": "aws-certbot",
                    "key": "secret_key"
                  }
                }
              }
            ]
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "external-dns",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://kubernetes-sigs.github.io/external-dns"
          }
        }
      }
    },
    "mon": {
      "namespace": "mon",
      "helmRepository": {
        "name": "prometheus-community",
        "url": "https://prometheus-community.github.io/helm-charts"
      },
      "chartName": "mon",
      "releaseName": "mon",
      "values": {
        "alertmanager": {
          "ingress": {
            "annotations": {
              "cert-manager.io/cluster-issuer": "letsencrypt-dns"
            },
            "enabled": true,
            "ingressClassName": "traefik",
            "hosts": [
              "mon.odell.sh"
            ],
            "paths": [
              "/alertmanager"
            ],
            "tls": [
              {
                "hosts": [
                  "mon.odell.sh"
                ],
                "secretName": "mon-tls"
              }
            ]
          },
          "alertmanagerSpec": {
            "externalUrl": "http://mon.odell.sh/alertmanager/",
            "routePrefix": "/alertmanager/"
          }
        },
        "defaultRules": {
          "rules": {
            "kubeScheduler": false,
            "etcd": false
          },
          "disabled": {
            "Watchdog": true,
            "KubeAggregatedAPIDown": true
          }
        },
        "grafana": {
          "enabled": true,
          "serviceMonitor": {
            "enabled": true
          },
          "ingress": {
            "annotations": {
              "cert-manager.io/cluster-issuer": "letsencrypt-dns"
            },
            "enabled": true,
            "ingressClassName": "traefik",
            "pathType": "Prefix",
            "hosts": [
              "mon.odell.sh"
            ],
            "paths": [
              "/grafana"
            ],
            "tls": [
              {
                "hosts": [
                  "mon.odell.sh"
                ],
                "secretName": "mon-tls"
              }
            ]
          },
          "deploymentStrategy": {
            "type": "Recreate"
          },
          "persistence": {
            "enabled": true,
            "type": "pvc",
            "storageClassName": "smb",
            "accessModes": [
              "ReadWriteOnce"
            ],
            "size": "10Gi"
          },
          "grafana.ini": {
            "server": {
              "domain": "mon.odell.sh",
              "root_url": "%(protocol)s://%(domain)s:%(http_port)s/grafana/",
              "serve_from_sub_path": true,
              "enable_gzip": true
            },
            "analytics": {
              "check_for_updates": false
            }
          },
          "sidecar": {
            "dashboards": {
              "searchNamespace": "ALL",
              "provider": {
                "allowUiUpdates": true
              }
            }
          }
        },
        "prometheus-node-exporter": {
          "prometheus": {
            "monitor": {
              "enabled": true
            }
          }
        },
        "prometheus": {
          "ingress": {
            "annotations": {
              "cert-manager.io/cluster-issuer": "letsencrypt-dns"
            },
            "enabled": true,
            "ingressClassName": "traefik",
            "hosts": [
              "mon.odell.sh"
            ],
            "paths": [
              "/prometheus"
            ],
            "tls": [
              {
                "hosts": [
                  "mon.odell.sh"
                ],
                "secretName": "mon-tls"
              }
            ]
          },
          "prometheusSpec": {
            "podMonitorSelectorNilUsesHelmValues": false,
            "serviceMonitorSelectorNilUsesHelmValues": false,
            "ruleSelectorNilUsesHelmValues": false,
            "replicas": 2,
            "resources": {
              "requests": {
                "cpu": "500m",
                "memory": "2300Mi"
              },
              "limits": {
                "cpu": "2",
                "memory": "4Gi"
              }
            },
            "externalUrl": "http://mon.odell.sh/prometheus/",
            "routePrefix": "/prometheus/",
            "retentionSize": "90GB",
            "walCompression": true,
            "storageSpec": {
              "volumeClaimTemplate": {
                "spec": {
                  "accessModes": [
                    "ReadWriteOnce"
                  ],
                  "resources": {
                    "requests": {
                      "storage": "100Gi"
                    }
                  },
                  "storageClassName": "openebs-lvm"
                }
              }
            }
          },
          "additionalScrapeConfigs": []
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "mon",
            "namespace": "mon"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "mon",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "prometheus-community"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "alertmanager": {
              "ingress": {
                "annotations": {
                  "cert-manager.io/cluster-issuer": "letsencrypt-dns"
                },
                "enabled": true,
                "ingressClassName": "traefik",
                "hosts": [
                  "mon.odell.sh"
                ],
                "paths": [
                  "/alertmanager"
                ],
                "tls": [
                  {
                    "hosts": [
                      "mon.odell.sh"
                    ],
                    "secretName": "mon-tls"
                  }
                ]
              },
              "alertmanagerSpec": {
                "externalUrl": "http://mon.odell.sh/alertmanager/",
                "routePrefix": "/alertmanager/"
              }
            },
            "defaultRules": {
              "rules": {
                "kubeScheduler": false,
                "etcd": false
              },
              "disabled": {
                "Watchdog": true,
                "KubeAggregatedAPIDown": true
              }
            },
            "grafana": {
              "enabled": true,
              "serviceMonitor": {
                "enabled": true
              },
              "ingress": {
                "annotations": {
                  "cert-manager.io/cluster-issuer": "letsencrypt-dns"
                },
                "enabled": true,
                "ingressClassName": "traefik",
                "pathType": "Prefix",
                "hosts": [
                  "mon.odell.sh"
                ],
                "paths": [
                  "/grafana"
                ],
                "tls": [
                  {
                    "hosts": [
                      "mon.odell.sh"
                    ],
                    "secretName": "mon-tls"
                  }
                ]
              },
              "deploymentStrategy": {
                "type": "Recreate"
              },
              "persistence": {
                "enabled": true,
                "type": "pvc",
                "storageClassName": "smb",
                "accessModes": [
                  "ReadWriteOnce"
                ],
                "size": "10Gi"
              },
              "grafana.ini": {
                "server": {
                  "domain": "mon.odell.sh",
                  "root_url": "%(protocol)s://%(domain)s:%(http_port)s/grafana/",
                  "serve_from_sub_path": true,
                  "enable_gzip": true
                },
                "analytics": {
                  "check_for_updates": false
                }
              },
              "sidecar": {
                "dashboards": {
                  "searchNamespace": "ALL",
                  "provider": {
                    "allowUiUpdates": true
                  }
                }
              }
            },
            "prometheus-node-exporter": {
              "prometheus": {
                "monitor": {
                  "enabled": true
                }
              }
            },
            "prometheus": {
              "ingress": {
                "annotations": {
                  "cert-manager.io/cluster-issuer": "letsencrypt-dns"
                },
                "enabled": true,
                "ingressClassName": "traefik",
                "hosts": [
                  "mon.odell.sh"
                ],
                "paths": [
                  "/prometheus"
                ],
                "tls": [
                  {
                    "hosts": [
                      "mon.odell.sh"
                    ],
                    "secretName": "mon-tls"
                  }
                ]
              },
              "prometheusSpec": {
                "podMonitorSelectorNilUsesHelmValues": false,
                "serviceMonitorSelectorNilUsesHelmValues": false,
                "ruleSelectorNilUsesHelmValues": false,
                "replicas": 2,
                "resources": {
                  "requests": {
                    "cpu": "500m",
                    "memory": "2300Mi"
                  },
                  "limits": {
                    "cpu": "2",
                    "memory": "4Gi"
                  }
                },
                "externalUrl": "http://mon.odell.sh/prometheus/",
                "routePrefix": "/prometheus/",
                "retentionSize": "90GB",
                "walCompression": true,
                "storageSpec": {
                  "volumeClaimTemplate": {
                    "spec": {
                      "accessModes": [
                        "ReadWriteOnce"
                      ],
                      "resources": {
                        "requests": {
                          "storage": "100Gi"
                        }
                      },
                      "storageClassName": "openebs-lvm"
                    }
                  }
                }
              },
              "additionalScrapeConfigs": []
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "mon",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://prometheus-community.github.io/helm-charts"
          }
        }
      }
    },
    "loki": {
      "namespace": "mon",
      "helmRepository": {
        "name": "grafana",
        "url": "https://grafana.github.io/helm-charts"
      },
      "chartName": "loki",
      "releaseName": "loki",
      "values": {
        "grafana": {
          "enabled": false
        },
        "isDefault": false,
        "loki": {
          "replicas": 2,
          "persistence": {
            "enabled": true,
            "storageClassName": "openebs-lvm",
            "accessModes": [
              "ReadWriteOnce"
            ],
            "size": "50Gi"
          },
          "serviceMonitor": {
            "enabled": true
          },
          "podManagementPolicy": "Parallel"
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "loki",
            "namespace": "mon"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "loki",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "grafana"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "grafana": {
              "enabled": false
            },
            "isDefault": false,
            "loki": {
              "replicas": 2,
              "persistence": {
                "enabled": true,
                "storageClassName": "openebs-lvm",
                "accessModes": [
                  "ReadWriteOnce"
                ],
                "size": "50Gi"
              },
              "serviceMonitor": {
                "enabled": true
              },
              "podManagementPolicy": "Parallel"
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "loki",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://grafana.github.io/helm-charts"
          }
        }
      }
    },
    "connect": {
      "namespace": "secrets",
      "helmRepository": {
        "name": "onepassword",
        "url": "https://1password.github.io/connect-helm-charts"
      },
      "chartName": "connect",
      "releaseName": "connect",
      "values": {
        "operator": {
          "create": true,
          "autoRestart": true,
          "pollingInterval": 600,
          "token": {
            "name": "connect",
            "key": "token"
          }
        },
        "connect": {
          "create": true,
          "credentialsName": "opcreds",
          "credentialsKey": "json",
          "serviceType": "ClusterIP"
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "connect",
            "namespace": "secrets"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "connect",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "onepassword"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "operator": {
              "create": true,
              "autoRestart": true,
              "pollingInterval": 600,
              "token": {
                "name": "connect",
                "key": "token"
              }
            },
            "connect": {
              "create": true,
              "credentialsName": "opcreds",
              "credentialsKey": "json",
              "serviceType": "ClusterIP"
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "connect",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://1password.github.io/connect-helm-charts"
          }
        }
      }
    },
    "openebs": {
      "namespace": "storage",
      "helmRepository": {
        "name": "openebs",
        "url": "https://openebs.github.io/charts"
      },
      "chartName": "openebs",
      "releaseName": "openebs",
      "values": {
        "lvm-localpv": {
          "enabled": true
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "openebs",
            "namespace": "storage"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "openebs",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "openebs"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "lvm-localpv": {
              "enabled": true
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "openebs",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://openebs.github.io/charts"
          }
        }
      }
    },
    "smb-csi": {
      "namespace": "storage",
      "helmRepository": {
        "name": "smb-csi",
        "url": "https://raw.githubusercontent.com/kubernetes-csi/csi-driver-smb/master/charts"
      },
      "chartName": "smb-csi",
      "releaseName": "smb-csi",
      "values": {},
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "smb-csi",
            "namespace": "storage"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "smb-csi",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "smb-csi"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {}
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "smb-csi",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://raw.githubusercontent.com/kubernetes-csi/csi-driver-smb/master/charts"
          }
        }
      }
    },
    "timescale": {
      "namespace": "data",
      "helmRepository": {
        "name": "timescale",
        "url": "https://charts.timescale.com"
      },
      "chartName": "timescale",
      "releaseName": "timescale",
      "values": {
        "persistentVolumes": {
          "data": {
            "size": "100Gi",
            "storageClass": "openebs-lvm"
          },
          "wal": {
            "size": "30Gi",
            "storageClass": "openebs-lvm"
          }
        },
        "resources": {
          "requests": {
            "cpu": "1",
            "memory": "2Gi"
          }
        },
        "timescaledbTune": {
          "args": {
            "cpus": "1",
            "memory": "2GB"
          }
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "timescale",
            "namespace": "data"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "timescale",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "timescale"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "persistentVolumes": {
              "data": {
                "size": "100Gi",
                "storageClass": "openebs-lvm"
              },
              "wal": {
                "size": "30Gi",
                "storageClass": "openebs-lvm"
              }
            },
            "resources": {
              "requests": {
                "cpu": "1",
                "memory": "2Gi"
              }
            },
            "timescaledbTune": {
              "args": {
                "cpus": "1",
                "memory": "2GB"
              }
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "timescale",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://charts.timescale.com"
          }
        }
      }
    }
  },
  "helmRepository": {},
  "cluster": {
    "tmm": {
      "name": "tmm",
      "nodeType": "multipass",
      "kubeType": "k3s",
      "fqdn": "odell.sh",
      "onePasswordVault": "homelab-tmm"
    },
    "alpha": {
      "name": "alpha",
      "nodeType": "physical",
      "kubeType": "k3s",
      "fqdn": "alpha.odell.sh",
      "onePasswordVault": "homelab-alpha"
    }
  },
  "flux": {
    "helmrepo": {}
  },
  "kubernetes": {
    "namespace": {
      "storage": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "storage",
            "secrets-injection": "enabled"
          },
          "name": "storage"
        }
      },
      "secrets": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "secrets",
            "secrets-injection": "enabled"
          },
          "name": "secrets"
        }
      },
      "network": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "network",
            "secrets-injection": "enabled"
          },
          "name": "network"
        }
      },
      "ha": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "ha",
            "secrets-injection": "enabled"
          },
          "name": "ha"
        }
      },
      "mon": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "mon",
            "secrets-injection": "enabled"
          },
          "name": "mon"
        }
      },
      "data": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "data",
            "secrets-injection": "enabled"
          },
          "name": "data"
        }
      }
    }
  }
}
{
  "helmApp": {
    "cert-manager": {
      "namespace": "network",
      "helmRepository": {
        "name": "cert-manager",
        "url": "https://charts.jetstack.io"
      },
      "chartName": "cert-manager",
      "releaseName": "cert-manager",
      "values": {
        "installCRDs": true,
        "prometheus": {
          "servicemonitor": {
            "enabled": false
          }
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "cert-manager",
            "namespace": "network"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "cert-manager",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "cert-manager"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "installCRDs": true,
            "prometheus": {
              "servicemonitor": {
                "enabled": false
              }
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "cert-manager",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://charts.jetstack.io"
          }
        }
      }
    },
    "external-dns": {
      "namespace": "network",
      "helmRepository": {
        "name": "external-dns",
        "url": "https://kubernetes-sigs.github.io/external-dns"
      },
      "chartName": "external-dns",
      "releaseName": "external-dns",
      "values": {
        "policy": "sync",
        "txtPrefix": "externaldns-",
        "txtOwnerId": "homelab",
        "provider": "aws",
        "env": [
          {
            "name": "AWS_ACCESS_KEY_ID",
            "valueFrom": {
              "secretKeyRef": {
                "name": "aws-certbot",
                "key": "access_key"
              }
            }
          },
          {
            "name": "AWS_SECRET_ACCESS_KEY",
            "valueFrom": {
              "secretKeyRef": {
                "name": "aws-certbot",
                "key": "secret_key"
              }
            }
          }
        ]
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "external-dns",
            "namespace": "network"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "external-dns",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "external-dns"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "policy": "sync",
            "txtPrefix": "externaldns-",
            "txtOwnerId": "homelab",
            "provider": "aws",
            "env": [
              {
                "name": "AWS_ACCESS_KEY_ID",
                "valueFrom": {
                  "secretKeyRef": {
                    "name": "aws-certbot",
                    "key": "access_key"
                  }
                }
              },
              {
                "name": "AWS_SECRET_ACCESS_KEY",
                "valueFrom": {
                  "secretKeyRef": {
                    "name": "aws-certbot",
                    "key": "secret_key"
                  }
                }
              }
            ]
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "external-dns",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://kubernetes-sigs.github.io/external-dns"
          }
        }
      }
    },
    "mon": {
      "namespace": "mon",
      "helmRepository": {
        "name": "prometheus-community",
        "url": "https://prometheus-community.github.io/helm-charts"
      },
      "chartName": "mon",
      "releaseName": "mon",
      "values": {
        "alertmanager": {
          "ingress": {
            "annotations": {
              "cert-manager.io/cluster-issuer": "letsencrypt-dns"
            },
            "enabled": true,
            "ingressClassName": "traefik",
            "hosts": [
              "mon.odell.sh"
            ],
            "paths": [
              "/alertmanager"
            ],
            "tls": [
              {
                "hosts": [
                  "mon.odell.sh"
                ],
                "secretName": "mon-tls"
              }
            ]
          },
          "alertmanagerSpec": {
            "externalUrl": "http://mon.odell.sh/alertmanager/",
            "routePrefix": "/alertmanager/"
          }
        },
        "defaultRules": {
          "rules": {
            "kubeScheduler": false,
            "etcd": false
          },
          "disabled": {
            "Watchdog": true,
            "KubeAggregatedAPIDown": true
          }
        },
        "grafana": {
          "enabled": true,
          "serviceMonitor": {
            "enabled": true
          },
          "ingress": {
            "annotations": {
              "cert-manager.io/cluster-issuer": "letsencrypt-dns"
            },
            "enabled": true,
            "ingressClassName": "traefik",
            "pathType": "Prefix",
            "hosts": [
              "mon.odell.sh"
            ],
            "paths": [
              "/grafana"
            ],
            "tls": [
              {
                "hosts": [
                  "mon.odell.sh"
                ],
                "secretName": "mon-tls"
              }
            ]
          },
          "deploymentStrategy": {
            "type": "Recreate"
          },
          "persistence": {
            "enabled": true,
            "type": "pvc",
            "storageClassName": "smb",
            "accessModes": [
              "ReadWriteOnce"
            ],
            "size": "10Gi"
          },
          "grafana.ini": {
            "server": {
              "domain": "mon.odell.sh",
              "root_url": "%(protocol)s://%(domain)s:%(http_port)s/grafana/",
              "serve_from_sub_path": true,
              "enable_gzip": true
            },
            "analytics": {
              "check_for_updates": false
            }
          },
          "sidecar": {
            "dashboards": {
              "searchNamespace": "ALL",
              "provider": {
                "allowUiUpdates": true
              }
            }
          }
        },
        "prometheus-node-exporter": {
          "prometheus": {
            "monitor": {
              "enabled": true
            }
          }
        },
        "prometheus": {
          "ingress": {
            "annotations": {
              "cert-manager.io/cluster-issuer": "letsencrypt-dns"
            },
            "enabled": true,
            "ingressClassName": "traefik",
            "hosts": [
              "mon.odell.sh"
            ],
            "paths": [
              "/prometheus"
            ],
            "tls": [
              {
                "hosts": [
                  "mon.odell.sh"
                ],
                "secretName": "mon-tls"
              }
            ]
          },
          "prometheusSpec": {
            "podMonitorSelectorNilUsesHelmValues": false,
            "serviceMonitorSelectorNilUsesHelmValues": false,
            "ruleSelectorNilUsesHelmValues": false,
            "replicas": 2,
            "resources": {
              "requests": {
                "cpu": "500m",
                "memory": "2300Mi"
              },
              "limits": {
                "cpu": "2",
                "memory": "4Gi"
              }
            },
            "externalUrl": "http://mon.odell.sh/prometheus/",
            "routePrefix": "/prometheus/",
            "retentionSize": "90GB",
            "walCompression": true,
            "storageSpec": {
              "volumeClaimTemplate": {
                "spec": {
                  "accessModes": [
                    "ReadWriteOnce"
                  ],
                  "resources": {
                    "requests": {
                      "storage": "100Gi"
                    }
                  },
                  "storageClassName": "openebs-lvm"
                }
              }
            }
          },
          "additionalScrapeConfigs": []
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "mon",
            "namespace": "mon"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "mon",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "prometheus-community"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "alertmanager": {
              "ingress": {
                "annotations": {
                  "cert-manager.io/cluster-issuer": "letsencrypt-dns"
                },
                "enabled": true,
                "ingressClassName": "traefik",
                "hosts": [
                  "mon.odell.sh"
                ],
                "paths": [
                  "/alertmanager"
                ],
                "tls": [
                  {
                    "hosts": [
                      "mon.odell.sh"
                    ],
                    "secretName": "mon-tls"
                  }
                ]
              },
              "alertmanagerSpec": {
                "externalUrl": "http://mon.odell.sh/alertmanager/",
                "routePrefix": "/alertmanager/"
              }
            },
            "defaultRules": {
              "rules": {
                "kubeScheduler": false,
                "etcd": false
              },
              "disabled": {
                "Watchdog": true,
                "KubeAggregatedAPIDown": true
              }
            },
            "grafana": {
              "enabled": true,
              "serviceMonitor": {
                "enabled": true
              },
              "ingress": {
                "annotations": {
                  "cert-manager.io/cluster-issuer": "letsencrypt-dns"
                },
                "enabled": true,
                "ingressClassName": "traefik",
                "pathType": "Prefix",
                "hosts": [
                  "mon.odell.sh"
                ],
                "paths": [
                  "/grafana"
                ],
                "tls": [
                  {
                    "hosts": [
                      "mon.odell.sh"
                    ],
                    "secretName": "mon-tls"
                  }
                ]
              },
              "deploymentStrategy": {
                "type": "Recreate"
              },
              "persistence": {
                "enabled": true,
                "type": "pvc",
                "storageClassName": "smb",
                "accessModes": [
                  "ReadWriteOnce"
                ],
                "size": "10Gi"
              },
              "grafana.ini": {
                "server": {
                  "domain": "mon.odell.sh",
                  "root_url": "%(protocol)s://%(domain)s:%(http_port)s/grafana/",
                  "serve_from_sub_path": true,
                  "enable_gzip": true
                },
                "analytics": {
                  "check_for_updates": false
                }
              },
              "sidecar": {
                "dashboards": {
                  "searchNamespace": "ALL",
                  "provider": {
                    "allowUiUpdates": true
                  }
                }
              }
            },
            "prometheus-node-exporter": {
              "prometheus": {
                "monitor": {
                  "enabled": true
                }
              }
            },
            "prometheus": {
              "ingress": {
                "annotations": {
                  "cert-manager.io/cluster-issuer": "letsencrypt-dns"
                },
                "enabled": true,
                "ingressClassName": "traefik",
                "hosts": [
                  "mon.odell.sh"
                ],
                "paths": [
                  "/prometheus"
                ],
                "tls": [
                  {
                    "hosts": [
                      "mon.odell.sh"
                    ],
                    "secretName": "mon-tls"
                  }
                ]
              },
              "prometheusSpec": {
                "podMonitorSelectorNilUsesHelmValues": false,
                "serviceMonitorSelectorNilUsesHelmValues": false,
                "ruleSelectorNilUsesHelmValues": false,
                "replicas": 2,
                "resources": {
                  "requests": {
                    "cpu": "500m",
                    "memory": "2300Mi"
                  },
                  "limits": {
                    "cpu": "2",
                    "memory": "4Gi"
                  }
                },
                "externalUrl": "http://mon.odell.sh/prometheus/",
                "routePrefix": "/prometheus/",
                "retentionSize": "90GB",
                "walCompression": true,
                "storageSpec": {
                  "volumeClaimTemplate": {
                    "spec": {
                      "accessModes": [
                        "ReadWriteOnce"
                      ],
                      "resources": {
                        "requests": {
                          "storage": "100Gi"
                        }
                      },
                      "storageClassName": "openebs-lvm"
                    }
                  }
                }
              },
              "additionalScrapeConfigs": []
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "mon",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://prometheus-community.github.io/helm-charts"
          }
        }
      }
    },
    "loki": {
      "namespace": "mon",
      "helmRepository": {
        "name": "grafana",
        "url": "https://grafana.github.io/helm-charts"
      },
      "chartName": "loki",
      "releaseName": "loki",
      "values": {
        "grafana": {
          "enabled": false
        },
        "isDefault": false,
        "loki": {
          "replicas": 2,
          "persistence": {
            "enabled": true,
            "storageClassName": "openebs-lvm",
            "accessModes": [
              "ReadWriteOnce"
            ],
            "size": "50Gi"
          },
          "serviceMonitor": {
            "enabled": true
          },
          "podManagementPolicy": "Parallel"
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "loki",
            "namespace": "mon"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "loki",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "grafana"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "grafana": {
              "enabled": false
            },
            "isDefault": false,
            "loki": {
              "replicas": 2,
              "persistence": {
                "enabled": true,
                "storageClassName": "openebs-lvm",
                "accessModes": [
                  "ReadWriteOnce"
                ],
                "size": "50Gi"
              },
              "serviceMonitor": {
                "enabled": true
              },
              "podManagementPolicy": "Parallel"
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "loki",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://grafana.github.io/helm-charts"
          }
        }
      }
    },
    "connect": {
      "namespace": "secrets",
      "helmRepository": {
        "name": "onepassword",
        "url": "https://1password.github.io/connect-helm-charts"
      },
      "chartName": "connect",
      "releaseName": "connect",
      "values": {
        "operator": {
          "create": true,
          "autoRestart": true,
          "pollingInterval": 600,
          "token": {
            "name": "connect",
            "key": "token"
          }
        },
        "connect": {
          "create": true,
          "credentialsName": "opcreds",
          "credentialsKey": "json",
          "serviceType": "ClusterIP"
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "connect",
            "namespace": "secrets"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "connect",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "onepassword"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "operator": {
              "create": true,
              "autoRestart": true,
              "pollingInterval": 600,
              "token": {
                "name": "connect",
                "key": "token"
              }
            },
            "connect": {
              "create": true,
              "credentialsName": "opcreds",
              "credentialsKey": "json",
              "serviceType": "ClusterIP"
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "connect",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://1password.github.io/connect-helm-charts"
          }
        }
      }
    },
    "openebs": {
      "namespace": "storage",
      "helmRepository": {
        "name": "openebs",
        "url": "https://openebs.github.io/charts"
      },
      "chartName": "openebs",
      "releaseName": "openebs",
      "values": {
        "lvm-localpv": {
          "enabled": true
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "openebs",
            "namespace": "storage"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "openebs",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "openebs"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "lvm-localpv": {
              "enabled": true
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "openebs",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://openebs.github.io/charts"
          }
        }
      }
    },
    "smb-csi": {
      "namespace": "storage",
      "helmRepository": {
        "name": "smb-csi",
        "url": "https://raw.githubusercontent.com/kubernetes-csi/csi-driver-smb/master/charts"
      },
      "chartName": "smb-csi",
      "releaseName": "smb-csi",
      "values": {},
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "smb-csi",
            "namespace": "storage"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "smb-csi",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "smb-csi"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {}
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "smb-csi",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://raw.githubusercontent.com/kubernetes-csi/csi-driver-smb/master/charts"
          }
        }
      }
    },
    "timescale": {
      "namespace": "data",
      "helmRepository": {
        "name": "timescale",
        "url": "https://charts.timescale.com"
      },
      "chartName": "timescale",
      "releaseName": "timescale",
      "values": {
        "persistentVolumes": {
          "data": {
            "size": "100Gi",
            "storageClass": "openebs-lvm"
          },
          "wal": {
            "size": "30Gi",
            "storageClass": "openebs-lvm"
          }
        },
        "resources": {
          "requests": {
            "cpu": "1",
            "memory": "2Gi"
          }
        },
        "timescaledbTune": {
          "args": {
            "cpus": "1",
            "memory": "2GB"
          }
        }
      },
      "flux": {
        "helmRelease": {
          "apiVersion": "helm.toolkit.fluxcd.io/v2beta1",
          "kind": "HelmRelease",
          "metadata": {
            "name": "timescale",
            "namespace": "data"
          },
          "spec": {
            "chart": {
              "spec": {
                "chart": "timescale",
                "reconcileStrategy": "ChartVersion",
                "sourceRef": {
                  "kind": "HelmRepository",
                  "name": "timescale"
                }
              }
            },
            "interval": "24h",
            "values": {}
          },
          "values": {
            "persistentVolumes": {
              "data": {
                "size": "100Gi",
                "storageClass": "openebs-lvm"
              },
              "wal": {
                "size": "30Gi",
                "storageClass": "openebs-lvm"
              }
            },
            "resources": {
              "requests": {
                "cpu": "1",
                "memory": "2Gi"
              }
            },
            "timescaledbTune": {
              "args": {
                "cpus": "1",
                "memory": "2GB"
              }
            }
          }
        },
        "helmRepo": {
          "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
          "kind": "HelmRepository",
          "metadata": {
            "name": "timescale",
            "namespace": "flux-system"
          },
          "spec": {
            "interval": "12h",
            "url": "https://charts.timescale.com"
          }
        }
      }
    }
  },
  "helmRepository": {
    "jetstack": {
      "name": "jetstack",
      "url": "https://charts.jetstack.io"
    },
    "external-dns": {
      "name": "external-dns",
      "url": "https://kubernetes-sigs.github.io/external-dns"
    },
    "grafana": {
      "name": "grafana",
      "url": "https://grafana.github.io/helm-charts"
    },
    "onepassword": {
      "name": "onepassword",
      "url": "https://1password.github.io/connect-helm-charts"
    },
    "prometheus-community": {
      "name": "prometheus-community",
      "url": "https://prometheus-community.github.io/helm-charts"
    },
    "smb-csi": {
      "name": "smb-csi",
      "url": "https://raw.githubusercontent.com/kubernetes-csi/csi-driver-smb/master/charts"
    },
    "timescale": {
      "name": "timescale",
      "url": "https://charts.timescale.com"
    }
  },
  "cluster": {
    "tmm": {
      "name": "tmm",
      "nodeType": "multipass",
      "kubeType": "k3s",
      "fqdn": "odell.sh",
      "onePasswordVault": "homelab-tmm"
    },
    "alpha": {
      "name": "alpha",
      "nodeType": "physical",
      "kubeType": "k3s",
      "fqdn": "alpha.odell.sh",
      "onePasswordVault": "homelab-alpha"
    }
  },
  "flux": {
    "helmrepo": {
      "jetstack": {
        "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
        "kind": "HelmRepository",
        "metadata": {
          "name": "jetstack",
          "namespace": "flux-system"
        },
        "spec": {
          "interval": "12h",
          "url": "https://charts.jetstack.io"
        }
      },
      "external-dns": {
        "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
        "kind": "HelmRepository",
        "metadata": {
          "name": "external-dns",
          "namespace": "flux-system"
        },
        "spec": {
          "interval": "12h",
          "url": "https://kubernetes-sigs.github.io/external-dns"
        }
      },
      "grafana": {
        "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
        "kind": "HelmRepository",
        "metadata": {
          "name": "grafana",
          "namespace": "flux-system"
        },
        "spec": {
          "interval": "12h",
          "url": "https://grafana.github.io/helm-charts"
        }
      },
      "onepassword": {
        "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
        "kind": "HelmRepository",
        "metadata": {
          "name": "onepassword",
          "namespace": "flux-system"
        },
        "spec": {
          "interval": "12h",
          "url": "https://1password.github.io/connect-helm-charts"
        }
      },
      "prometheus-community": {
        "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
        "kind": "HelmRepository",
        "metadata": {
          "name": "prometheus-community",
          "namespace": "flux-system"
        },
        "spec": {
          "interval": "12h",
          "url": "https://prometheus-community.github.io/helm-charts"
        }
      },
      "smb-csi": {
        "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
        "kind": "HelmRepository",
        "metadata": {
          "name": "smb-csi",
          "namespace": "flux-system"
        },
        "spec": {
          "interval": "12h",
          "url": "https://raw.githubusercontent.com/kubernetes-csi/csi-driver-smb/master/charts"
        }
      },
      "timescale": {
        "apiVersion": "source.toolkit.fluxcd.io/v1beta2",
        "kind": "HelmRepository",
        "metadata": {
          "name": "timescale",
          "namespace": "flux-system"
        },
        "spec": {
          "interval": "12h",
          "url": "https://charts.timescale.com"
        }
      }
    }
  },
  "kubernetes": {
    "namespace": {
      "storage": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "storage",
            "secrets-injection": "enabled"
          },
          "name": "storage"
        }
      },
      "secrets": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "secrets",
            "secrets-injection": "enabled"
          },
          "name": "secrets"
        }
      },
      "network": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "network",
            "secrets-injection": "enabled"
          },
          "name": "network"
        }
      },
      "ha": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "ha",
            "secrets-injection": "enabled"
          },
          "name": "ha"
        }
      },
      "mon": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "mon",
            "secrets-injection": "enabled"
          },
          "name": "mon"
        }
      },
      "data": {
        "apiVersion": "v1",
        "kind": "Namespace",
        "metadata": {
          "labels": {
            "kubernetes.io/metadata.name": "data",
            "secrets-injection": "enabled"
          },
          "name": "data"
        }
      }
    }
  }
}
