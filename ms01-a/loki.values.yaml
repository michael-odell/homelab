# overall loki-stack ref: https://github.com/grafana/helm-charts/blob/main/charts/loki-stack/values.yaml

# grafana readme: https://github.com/grafana/helm-charts/tree/main/charts/grafana
# grafana values: https://github.com/grafana/helm-charts/blob/main/charts/grafana/values.yaml
grafana:
  enabled: false

# Whether loki should present itself as the _default_ data source to grafana
isDefault: false

# loki values: https://github.com/grafana/helm-charts/blob/loki-2.15.2/charts/loki/values.yaml
loki:
  #replicas: 2
  commonConfig:
    replication_factor: 1
  persistence:
    enabled: false
  #  storageClassName: openebs-lvm
  #  accessModes:
  #    - ReadWriteOnce
  #  size: 50Gi

  serviceMonitor:
    enabled: true

  #podManagementPolicy: Parallel

# WARNING: Structure of values for promtail changes in net next version
# Scrape systemd logs, too -- from the docs:
#  - https://grafana.com/docs/loki/latest/installation/helm/#run-promtail-with-systemd-journal-support
promtail:
  extraScrapeConfigs:
    - job_name: journal
      journal:
        path: /var/log/journal
        max_age: 12h
        labels:
          job: systemd-journal
      relabel_configs:
        - source_labels: ['__journal__systemd_unit']
          target_label: 'unit'
        - source_labels: ['__journal__hostname']
          target_label: 'hostname'

  serviceMontior:
    enabled: true

  # Mount journal directory into Promtail pods
  #extraVolumes:
  #  - name: journal
  #    hostPath:
  #      path: /var/log/journal

  #extraVolumeMounts:
  #  - name: journal
  #    mountPath: /var/log/journal
  #    readOnly: true

